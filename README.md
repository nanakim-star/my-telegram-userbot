# 텔레그램 Userbot 자동 홍보 프로그램

이 프로젝트는 텔레그램 사용자 계정(Userbot)을 제어하여, 지정된 여러 그룹/채널에 설정된 홍보 메시지를 자동으로 발송하는 시스템입니다. 모든 제어는 웹 기반 관리자 페이지에서 이루어집니다.

---

## ⚙️ 1. 필수 환경 변수 설정

이 프로그램이 작동하려면 아래의 비밀 값들을 서버(Render) 또는 개발 환경(Codespaces Secrets)에 반드시 등록해야 합니다.

| 변수 이름 | 설명 | 얻는 곳 |
| :--- | :--- | :--- |
| `API_ID` | Userbot 계정의 API ID | [my.telegram.org](https://my.telegram.org) |
| `API_HASH` | Userbot 계정의 API Hash | [my.telegram.org](https://my.telegram.org) |
| `SESSION_STRING` | Userbot 로그인 세션 문자열 | `generate_string_session.py` 실행 |
| `PHOTO_STORAGE_ID` | 사진 저장용 비공개 채널 ID | ID 확인 봇으로 확인 |
| `DATABASE_URL` | Render PostgreSQL 데이터베이스 주소 | Render 대시보드 |
| `ADMIN_USERNAME` | 관리자 페이지 로그인 아이디 | 직접 설정 |
| `ADMIN_PASSWORD` | 관리자 페이지 로그인 비밀번호 | 직접 설정 |
| `SECRET_KEY` | Flask 세션 암호화용 비밀 키 | 직접 설정 (아무 긴 문자열) |

---

## 🚀 2. Render 서버 배포 설정

| 설정 항목 | 값 |
| :--- | :--- |
| **Instance Type** | Starter ($7/mo) - 사진 기능 사용 시 |
| **Build Command** | `pip install -r requirements.txt` |
| **Start Command** | `gunicorn userbot_app:app` |

---

## 📖 3. 관리자 페이지 사용 설명서

### 대시보드 & 봇 제어
- **스케줄러 상태**: 봇의 자동 발송 기능을 켜거나(`다시 시작`) 끌 수(`긴급 중단`) 있습니다.
- **현황판**: 오늘 보낸 메시지 수와 등록된 전체 홍보방 수를 보여줍니다.
- **최근 활동 로그**: 봇이 최근에 한 활동(성공/실패)을 보여줍니다.
- **내 모든 대화방 관리하기**: Userbot이 참여한 모든 대화방 목록을 보고, 홍보방으로 쉽게 추가할 수 있는 페이지로 이동합니다.

### 기본 설정
- **홍보 문구**: 보낼 메시지를 작성합니다. `{안녕|방가}` 형식으로 쓰면 둘 중 하나가 랜덤으로 나갑니다.
- **홍보용 사진**:
    1. '사진 저장소' 비공개 채널에 홍보용 사진을 올립니다.
    2. 올린 사진의 **메시지 링크를 복사**합니다.
    3. 링크의 맨 마지막 숫자(메시지 ID)를 이 칸에 붙여넣습니다.
- **미리보기 테스트**: `@사용자명`이나 숫자 ID를 넣고 버튼을 누르면, 현재 설정된 메시지를 즉시 테스트 발송합니다.
- **랜덤 발송 간격**: 설정한 최소~최대 시간(분) 사이에서 랜덤한 주기로 메시지를 보냅니다.
- **저장하기**: 모든 변경사항은 **'기본 설정 저장하기'** 버튼을 눌러야 적용됩니다.

### 홍보방 관리
- **신규 방 추가**: ID, 이름, 그룹명을 입력하여 홍보할 방을 수동으로 추가합니다.
- **일괄 관리**:
    - **CSV 가져오기/내보내기**: 여러 개의 방을 파일로 한 번에 등록하거나 백업합니다.
    - **모든 방 상태 확인**: 등록된 방에 Userbot이 정상적으로 참여 중인지 확인합니다.
- **등록된 방 목록**:
    - **선택/전체 삭제**: 체크박스로 방을 선택하거나 전체를 삭제합니다.
    - **삭제**: 특정 방 하나를 목록에서 제거합니다.
